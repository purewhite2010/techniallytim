<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Submitting Empty Checkboxes when in ArrayTechnically Tim</title>

    <link rel="stylesheet" href="//tim.purewhite.id.au/theme/css/main.css">
    <link rel="stylesheet" href="//tim.purewhite.id.au/theme/css/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <div><img src="" class="grv-img"/></div>
        <div class="title"><a href="//tim.purewhite.id.au/">Technically Tim </a></div>
        <div class="sub-title"></div>

<p>
    <div class="view"><a href="//tim.purewhite.id.au/about.html">About</a></div>
  <div class="view"><a href="//tim.purewhite.id.au/archives.html">Archives</a></div>
</p>

<!-- Social links -->

      </header>
      <section>
<section id="content" class="body">
  <article>
      <div class="article-title">
        Submitting Empty Checkboxes when in Array
      </div>

    <div class="entry-content">
<p>
<small>
<abbr class="published" title="2012-09-11T15:20:00">
  Tue 11 September 2012
</abbr> | 
  tags: 
    <a href="//tim.purewhite.id.au/tag/array">array</a>, 
    <a href="//tim.purewhite.id.au/tag/checkboxes">checkboxes</a>, 
    <a href="//tim.purewhite.id.au/tag/empty">empty</a>, 
    <a href="//tim.purewhite.id.au/tag/html">HTML</a>, 
    <a href="//tim.purewhite.id.au/tag/submit">submit</a>, 
 -- (<a href="//tim.purewhite.id.au/2012/09/submitting-empty-checkboxes-when-in-array/" rel="bookmark">permalink</a>)
</small>
</p>      <p>In HTML, we often use a nice feature for POSTing a form, or submitting a
form, where we have lots of items the "same". In the Grase Hotspot
project, we have groups for example, and we can dynamically add and
delete groups, but need a complete form for each group with it's
settings. So we use an "array" to submit the values. Simple put, we have
a number of \&lt;inputs> with the same name, but with square brackets on
the end. i.e. \&lt;input type="text" name="groupprice[]"/>, and we have
multiples of these. Thanks to page ordering, we can have a number of
different arrays as well, and can associate all the group values
together thanks to their positions in each array.</p>
<p>However, this breaks when we are submitting checkboxes, because
unchecked checkboxes won't submit. When unchecked, they are a form
element that isn't successful, and only successful form elements are
submitted. That's fine, except we are relying on the array behaviour to
match elements together, and when a checkbox isn't submitted, it doesn't
even take up an array position, it's just absent, which means all
following checkboxes on the page are now in the wrong spot in the array
and not matched with the other arrays.</p>
<p>So normally when we submit input fields and some items have been left
blank, they still consume a spot in the array, like so.</p>
<div class="highlight"><pre><span></span><span class="x">array(4) {</span>
<span class="x">[0]=&gt;</span>
<span class="x">string(6) &quot;Item 1&quot;</span>
<span class="x">[1]=&gt;</span>
<span class="x">string(0) &quot;&quot;</span>
<span class="x">[2]=&gt;</span>
<span class="x">string(0) &quot;&quot;</span>
<span class="x">[3]=&gt;</span>
<span class="x">string(6) &quot;Item 4&quot;</span>
<span class="x">}</span>
</pre></div>


<p>However, the checkboxes (which have a value on On normally when
checked), would appear like so (with Item numbers instead of "On" for
clarity)</p>
<div class="highlight"><pre><span></span><span class="x">array(2) {</span>
<span class="x">[0]=&gt;</span>
<span class="x">string(6) &quot;Item 1&quot;</span>
<span class="x">[1]=&gt;</span>
<span class="x">string(6) &quot;Item 4&quot;</span>
<span class="x">}</span>
</pre></div>


<p>There are solutions out there, however none work very well for dynamic
adding and creating "groups" of data, including checkboxes. Given that
the dynamic creation and deletion of those groups is with Javascript,
I've turned to a small javascript snippit to get it working. Hopefully
I'll find a nice way to have it fallback when javascript is disabled.</p>
<p>I found the solution I'm using at <a href="http://www.dwright.us/?p=472">http://www.dwright.us/?p=472</a> however
couldn't get it working well. A bit of fiddling and working on the
solution in the comments and I came up with the following snippit that
works nicely for me.</p>
<div class="highlight"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="c1">// do when submit is pressed</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">).</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;input:checkbox:not(:checked)&#39;</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">));</span>
                <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">before</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;input&gt;&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;_temp&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)));</span>
                <span class="c1">// .val(&#39;off&#39;));</span>
        <span class="p">});</span>  
    <span class="p">});</span>

<span class="p">});</span>
</pre></div>


<p>One of the main things I changed (once I made it work) was not having it
set the "extra" inputs to the value of "Off", but leaving them as an
empty value. This is because in my code I run the incoming arrays
through array_filter which removes all the empty ones (and maintains
the array indexes so the order and position is still there).</p>
    </div><!-- /.entry-content -->
<script src="https://apis.google.com/js/plusone.js">
</script>
<div class="g-comments"
    data-href = "http://tim.purewhite.id.au/2012/09/submitting-empty-checkboxes-when-in-array/"
    data-width = "650"
    data-first_party_property = "BLOGGER"
    data-view_type = "FILTERED_POSTMOD">
</div>

  </article>
</section>
      </section>
      <footer>
        <p><small>&copy; Technically Tim &mdash; Theme based on Sundown by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <!-- Scale fix -->
    <script>
      var metas = document.getElementsByTagName('meta');
      var i;
      
      if (navigator.userAgent.match(/iPhone/i)) {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=1.0, maximum-scale=1.0";
          }
        }
      
        document.addEventListener("gesturestart", gestureStart, false);
      }

      function gestureStart() {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=0.25, maximum-scale=1.6";
          }
        }
      }
    </script>
    <script type="text/javascript">
        var pkBaseURL = (("https:" == document.location.protocol) ? "https://piwik.purewhite.id.au/" : "http://piwik.purewhite.id.au/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 4);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://piwik.purewhite.id.au/piwik.php?idsite=4" style="border:0" alt="" /></p></noscript>
    <a href="https://github.com/purewhite2010/technicallytim"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
  </body>
</html>